import{N as C}from"./NotLoginCard-COCyxhjT.js";import{_ as T}from"./time-util-nx3sX2E9.js";import{U as w}from"./ua-parser-DP5omx3I.js";import{_ as k,c as h,w as o,r as i,o as m,a as e,f as a,e as b,t as c,u as U,b as E,F as I,d as L}from"./index-TiTfTDly.js";const N={name:"HistoryCard",props:{video:{type:Object,default:()=>({})}},data(){return{TimeUtil:T,videoInfo:this.video}},computed:{getLengthPercent(){var s,t,n,_;return!((t=(s=this.video)==null?void 0:s.playRecordingEntity)!=null&&t.videoTime)||!((_=(n=this.video)==null?void 0:n.articleEntity)!=null&&_.duration)?0:this.video.playRecordingEntity.videoTime/this.video.articleEntity.duration*100}},methods:{getUaInfo(s){const t=new w(s);return`操作系统：${t.getOS().name} ${t.getOS().version} 浏览器：${t.getBrowser().name} ${t.getBrowser().major}`}}},R={class:"d-flex fill-height align-end"},V={class:"d-flex flex-column h-100"},B={class:"text-h6 text-truncate-2 mb-1 text-black"},z={class:"text-body-2 text-medium-emphasis mb-1"},H={class:"text-body-2 text-medium-emphasis d-flex align-center mb-1"},P={class:"text-body-2 text-medium-emphasis text-truncate-3 mt-auto"};function S(s,t,n,_,r,v){const g=i("v-chip"),u=i("v-progress-linear"),l=i("v-img"),p=i("router-link"),f=i("v-col"),y=i("v-icon"),x=i("v-row"),d=i("v-card");return m(),h(d,{class:"mb-4 history-card",variant:"flat",elevation:0,hover:!0},{default:o(()=>[e(x,{"no-gutters":""},{default:o(()=>[e(f,{cols:"12",sm:"4",md:"3",class:"pa-2"},{default:o(()=>[e(p,{to:`/video/${n.video.articleEntity.id}?seek=${n.video.playRecordingEntity.videoTime}`,class:"text-decoration-none"},{default:o(()=>[e(l,{src:n.video.articleEntity.imgUrl,"aspect-ratio":16/9,cover:"",class:"rounded",height:"100%"},{default:o(()=>[a("div",R,[e(g,{variant:"text",color:"white",size:"small",class:"mb-1 mr-1 bg-black-transparent"},{default:o(()=>[b(c(r.TimeUtil.timeCover(r.videoInfo.articleEntity.duration)),1)]),_:1}),e(u,{"model-value":v.getLengthPercent,color:"red-darken-2",height:"6",class:"mt-auto mb-0 video-progress"},null,8,["model-value"])])]),_:1},8,["src"])]),_:1},8,["to"])]),_:1}),e(f,{cols:"12",sm:"8",md:"9",class:"pa-3"},{default:o(()=>[a("div",V,[e(p,{to:`/video/${n.video.articleEntity.id}?seek=${n.video.playRecordingEntity.videoTime}`,class:"text-decoration-none"},{default:o(()=>[a("div",B,c(n.video.articleEntity.title),1)]),_:1},8,["to"]),a("div",z,[e(y,{size:"small",icon:"mdi-timer-outline",class:"mr-1"}),a("strong",null,"观看到："+c(r.TimeUtil.timeCover(n.video.playRecordingEntity.videoTime)),1),t[0]||(t[0]=a("span",{class:"mx-2"},"|",-1)),a("span",null,"播放时间："+c(r.TimeUtil.renderTime(n.video.playRecordingEntity.updateTime)),1)]),a("div",H,[t[1]||(t[1]=a("span",{class:"mr-1"},"播放设备：",-1)),e(g,{size:"x-small",color:"primary",variant:"flat",class:"ml-1"},{default:o(()=>[b(c(v.getUaInfo(n.video.playRecordingEntity.ua)),1)]),_:1})]),a("div",P,c(n.video.articleEntity.describes),1)])]),_:1})]),_:1})]),_:1})}const D=k(N,[["render",S],["__scopeId","data-v-a5f83c9a"]]),O={components:{NotLoginCard:C,HistoryCard:D},data(){return{videoList:[],page:1,size:20,length:1,userInfo:U()}},created(){this.userInfo.userData!=null&&this.init()},methods:{init(){this.httpGet(`/user/playrecording/list?page=${this.page}&limit=${this.size}`,s=>{this.videoList=s.data.list,this.page=s.data.currPage,this.length=s.data.totalPage})},pageChange(s){this.page=s,this.init(this.type),this.$vuetify.goTo(0)}}},F={key:1};function j(s,t,n,_,r,v){const g=i("NotLoginCard"),u=i("v-col"),l=i("v-row"),p=i("v-divider"),f=i("HistoryCard"),y=i("v-pagination"),x=i("v-container");return m(),h(x,null,{default:o(()=>[r.userInfo.userData==null?(m(),h(g,{key:0})):(m(),E("div",F,[e(l,null,{default:o(()=>[e(u,null,{default:o(()=>t[1]||(t[1]=[a("h2",null,"播放历史",-1)])),_:1})]),_:1}),e(l,null,{default:o(()=>[e(u,null,{default:o(()=>[e(p)]),_:1})]),_:1}),e(l,null,{default:o(()=>[(m(!0),E(I,null,L(r.videoList,d=>(m(),h(u,{key:d.id,cols:"12"},{default:o(()=>[e(f,{video:d},null,8,["video"])]),_:2},1024))),128))]),_:1}),e(l,{justify:"center"},{default:o(()=>[e(y,{rounded:"circle","total-visible":7,modelValue:r.page,"onUpdate:modelValue":t[0]||(t[0]=d=>r.page=d),length:r.length,onInput:v.pageChange},null,8,["modelValue","length","onInput"])]),_:1})]))]),_:1})}const J=k(O,[["render",j]]);export{J as default};
