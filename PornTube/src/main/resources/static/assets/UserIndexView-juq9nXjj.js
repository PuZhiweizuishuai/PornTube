import{_ as w}from"./time-util-nx3sX2E9.js";import{_ as T,c as p,w as e,r as s,o as a,a as o,f as u,e as l,t as r,g,h as P,u as z,b as I,F as O,d as D}from"./index-TiTfTDly.js";import{_ as N}from"./string-utils-8vaaKgF8.js";function B(i){if(i.userRoleEntity.role==="ROLE_ADMIN")return"admin";if(i.userRoleEntity.role==="ROLE_VIP")return i.userRoleEntity.vipStopTime<new Date().getTime()?"user":"vip";if(i.userRoleEntity.role==="ROLE_USER")return"user"}function M(i){return i.userRoleEntity.role==="ROLE_VIP"?!(i.userRoleEntity.vipStopTime<new Date().getTime()):i.userRoleEntity.role==="ROLE_ADMIN"}function A(i){return i===null?!1:i.userRoleEntity.role==="ROLE_VIP"&&i.userRoleEntity.vipStopTime<new Date().getTime()}const F={checkPower:B,updateUserRole:A,checkVip:M},G={name:"VideoList",props:{video:{type:Object,default:()=>{}}},data(){return{TimeUtil:w,StringUtils:N,videoInfo:this.video}}},H={class:"d-flex fill-height align-end"},j=["textContent"],W=["textContent"],q=["textContent"];function J(i,t,m,V,n,_){const y=s("v-chip"),f=s("v-img"),d=s("router-link"),x=s("v-col"),v=s("v-row");return a(),p(v,{style:{"padding-top":"12px","padding-bottom":"12px"}},{default:e(()=>[o(x,{cols:"3"},{default:e(()=>[o(d,{to:`/video/${m.video.id}`},{default:e(()=>[o(f,{src:m.video.imgUrl,"aspect-ratio":"1.77","max-width":"400",class:"white--text align-end"},{default:e(()=>[u("div",H,[o(y,{style:{"background-color":"rgba(0, 0, 0, 50%)"},variant:"text",color:"white",size:"small",class:"mb-1 mr-1 bg-black-transparent"},{default:e(()=>[l(r(n.TimeUtil.timeCover(m.video.duration)),1)]),_:1})])]),_:1},8,["src"])]),_:1},8,["to"])]),_:1}),o(x,null,{default:e(()=>[o(v,{style:{"padding-top":"6px"}},{default:e(()=>[o(d,{to:`/video/${m.video.id}`},{default:e(()=>[u("h3",null,[l(r(m.video.title)+" ",1),n.videoInfo.pixelsNumber>=2073600?(a(),p(y,{key:0,class:"ma-2",color:"orange","x-small":"","text-color":"white"},{default:e(()=>[l(r(n.StringUtils.clarityDisplay(m.video.pixelsNumber)),1)]),_:1})):g("",!0)])]),_:1},8,["to"])]),_:1}),o(v,{style:{color:"#606060","fount-size":"12px","padding-top":"6px"}},{default:e(()=>[l(" 播放： "+r(m.video.viewCount)+" ",1),t[0]||(t[0]=u("span",{innerHTML:"   "},null,-1)),l(" 弹幕： "+r(m.video.danmakuCount),1)]),_:1}),o(v,{style:{color:"#606060","fount-size":"12px","padding-top":"6px"}},{default:e(()=>[t[1]||(t[1]=l(" 分区： ")),n.videoInfo.childrenCategory.fatherId!==0?(a(),p(d,{key:0,to:`/v/${n.videoInfo.fatherCategory.id}`,class:"category-link"},{default:e(()=>[u("span",{textContent:r(n.videoInfo.fatherCategory.name)},null,8,j)]),_:1},8,["to"])):g("",!0),t[2]||(t[2]=l(" / ")),o(d,{to:`/v/${n.videoInfo.childrenCategory.id}`,class:"category-link"},{default:e(()=>[u("span",{textContent:r(n.videoInfo.childrenCategory.name)},null,8,W)]),_:1},8,["to"]),t[3]||(t[3]=u("br",null,null,-1))]),_:1}),o(v,{style:{color:"#606060","fount-size":"12px","padding-top":"6px"}},{default:e(()=>[t[4]||(t[4]=l(" 发布于： ")),u("span",{textContent:r(n.TimeUtil.renderTime(m.video.createTime))},null,8,q)]),_:1}),o(v,{style:{color:"#606060","fount-size":"12px","padding-top":"6px"}},{default:e(()=>[l(r(m.video.describes.substring(0,15)),1)]),_:1})]),_:1})]),_:1})}const K=T(G,[["render",J]]),Q={name:"UserHome",components:{VideoListView:K},data(){return{TimeUtil:w,Power:F,id:0,userInfo:null,videoList:[],page:1,size:20,length:1,totalCount:0,type:0,loginUser:z().userData}},created(){this.id=this.$route.params.id,this.id=parseInt(this.$route.params.id),this.getUserInfo(),this.geVideoList()},methods:{getUserInfo(){this.httpGet(`/user/info/${this.id}`,i=>{this.userInfo=i.data,document.title=P().webInfo.name+" - "+i.data.username,i.data.id===-1&&this.$router.push("/404")})},geVideoList(){this.httpGet(`/article/user/list/${this.id}?page=${this.page}&limit=${this.size}&type=${this.type}`,i=>{this.videoList=i.data.list,this.page=i.data.currPage,this.length=i.data.totalPage,this.totalCount=i.data.totalCount})},pageChange(i){this.page=i,this.geVideoList(this.type),this.$vuetify.goTo(0)},setType(i){this.type=i,this.page=1,i!==4&&(this.geVideoList(),this.$vuetify.goTo(0))},goTOVIP(){this.$router.push("/vip")},goToStudio(){this.$router.push("/studio")},goToSetting(){this.$router.push("/user/setting")}}},X={class:"d-flex flex-column flex-sm-row align-start align-sm-center"},Y={class:"flex-grow-1"},Z={class:"d-flex align-center"},$={class:"text-h5 font-weight-bold"},ee={class:"text-subtitle-2 text-grey mt-1"},te={key:0,class:"d-flex d-md-none align-center mt-3"},oe={class:"text-subtitle-1 mr-3"},ne={class:"font-weight-bold"},ie={class:"d-flex align-center"},le={class:"text-subtitle-1 mr-4"},se={class:"font-weight-bold"},re={key:0};function ue(i,t,m,V,n,_){const y=s("v-img"),f=s("v-col"),d=s("v-row"),x=s("v-avatar"),v=s("v-icon"),U=s("v-chip"),h=s("v-btn"),b=s("v-card"),C=s("v-tab"),L=s("v-tabs"),k=s("v-container"),E=s("v-divider"),R=s("VideoListView"),S=s("v-pagination");return a(),p(k,{fluid:""},{default:e(()=>[n.userInfo!=null?(a(),p(d,{key:0},{default:e(()=>[o(f,{style:{padding:"0px"}},{default:e(()=>[o(y,{src:n.userInfo.topImgUrl,"aspect-ratio":5.98},null,8,["src"])]),_:1})]),_:1})):g("",!0),o(k,null,{default:e(()=>[n.userInfo!=null?(a(),p(d,{key:0,justify:"center",class:"py-4"},{default:e(()=>[o(f,{cols:"12",md:"8"},{default:e(()=>[o(b,{flat:"",class:"pa-4"},{default:e(()=>[u("div",X,[o(x,{size:"80",class:"mr-sm-4 mb-4 mb-sm-0"},{default:e(()=>[o(y,{src:n.userInfo.avatarUrl,alt:"用户头像"},null,8,["src"])]),_:1}),u("div",Y,[u("div",Z,[u("h2",$,r(n.userInfo.username),1),n.Power.checkPower(n.userInfo)==="vip"?(a(),p(U,{key:0,color:"yellow",class:"ml-2",onClick:t[0]||(t[0]=c=>_.goTOVIP())},{default:e(()=>[o(v,{left:"",size:"small"},{default:e(()=>t[6]||(t[6]=[l("mdi-crown")])),_:1}),t[7]||(t[7]=l(" VIP "))]),_:1})):g("",!0)]),u("div",ee," 个性签名："+r(n.userInfo.introduction),1),n.loginUser&&n.loginUser.id==n.id?g("",!0):(a(),I("div",te,[u("div",oe,[t[8]||(t[8]=l(" 粉丝: ")),u("span",ne,r(n.userInfo.fansCount),1)]),o(h,{color:"primary",size:"small","prepend-icon":"mdi-account-plus"},{default:e(()=>t[9]||(t[9]=[l(" 关注 ")])),_:1})]))])])]),_:1})]),_:1}),n.loginUser&&n.loginUser.id==n.id?(a(),p(f,{key:0,cols:"12",md:"4",class:"d-flex align-center justify-center justify-md-end mt-2 mt-md-0"},{default:e(()=>[o(h,{color:"primary",variant:"elevated",class:"mx-1","prepend-icon":"mdi-cog",onClick:_.goToSetting},{default:e(()=>t[10]||(t[10]=[l(" 自定义频道 ")])),_:1},8,["onClick"]),o(h,{color:"primary",variant:"elevated",class:"mx-1","prepend-icon":"mdi-video",onClick:_.goToStudio},{default:e(()=>t[11]||(t[11]=[l(" 创作中心 ")])),_:1},8,["onClick"])]),_:1})):(a(),p(f,{key:1,cols:"12",md:"4",class:"d-none d-md-flex align-center justify-end mt-md-0"},{default:e(()=>[o(b,{flat:"",class:"pa-2"},{default:e(()=>[u("div",ie,[u("div",le,[t[12]||(t[12]=l(" 粉丝数： ")),u("span",se,r(n.userInfo.fansCount),1)]),o(h,{color:"primary",variant:"elevated","prepend-icon":"mdi-account-plus"},{default:e(()=>t[13]||(t[13]=[l(" 关注他 ")])),_:1})])]),_:1})]),_:1}))]),_:1})):g("",!0),o(L,null,{default:e(()=>[o(C,{onClick:t[1]||(t[1]=c=>_.setType(0))},{default:e(()=>t[14]||(t[14]=[l("首页")])),_:1}),o(C,{onClick:t[2]||(t[2]=c=>_.setType(0))},{default:e(()=>t[15]||(t[15]=[l("视频")])),_:1}),o(C,{onClick:t[3]||(t[3]=c=>_.setType(2))},{default:e(()=>t[16]||(t[16]=[l("讨论")])),_:1}),o(C,{onClick:t[4]||(t[4]=c=>_.setType(4))},{default:e(()=>t[17]||(t[17]=[l("简介")])),_:1})]),_:1})]),_:1}),o(E),o(k,null,{default:e(()=>[t[18]||(t[18]=u("div",{id:"top"},null,-1)),n.type==4?(a(),I("div",re,[o(d,null,{default:e(()=>[o(f,null,{default:e(()=>[l(" 用户名: "+r(n.userInfo.username),1)]),_:1})]),_:1}),o(d,null,{default:e(()=>[o(f,null,{default:e(()=>[l(" 简介： "+r(n.userInfo.introduction),1)]),_:1})]),_:1}),o(d,null,{default:e(()=>[o(f,null,{default:e(()=>[l(" 视频总数： "+r(n.userInfo.submitCount),1)]),_:1})]),_:1}),o(d,null,{default:e(()=>[o(f,null,{default:e(()=>[l(" 粉丝数： "+r(n.userInfo.fansCount),1)]),_:1})]),_:1}),o(d,null,{default:e(()=>[o(f,null,{default:e(()=>[l(" 关注数： "+r(n.userInfo.followCount),1)]),_:1})]),_:1}),o(d,null,{default:e(()=>[o(f,null,{default:e(()=>[l(" 加入时间： "+r(n.TimeUtil.renderTime(n.userInfo.createTime)),1)]),_:1})]),_:1})])):g("",!0),n.type!=4?(a(),p(d,{key:1},{default:e(()=>[(a(!0),I(O,null,D(n.videoList,c=>(a(),p(f,{key:c.id,cols:"12"},{default:e(()=>[o(R,{video:c},null,8,["video"])]),_:2},1024))),128))]),_:1})):g("",!0),o(d,{justify:"center",style:{"padding-top":"12px","padding-bottom":"12px"}},{default:e(()=>[o(S,{"total-visible":7,modelValue:n.page,"onUpdate:modelValue":[t[5]||(t[5]=c=>n.page=c),_.pageChange],length:n.length,rounded:"circle"},null,8,["modelValue","length","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})}const me=T(Q,[["render",ue]]);export{me as default};
