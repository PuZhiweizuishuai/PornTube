import{_ as F}from"./time-util-nx3sX2E9.js";import{_ as G,c as u,w as e,r as i,o as p,a as o,e as n,f as g,m as q,g as c,t as d}from"./index-TiTfTDly.js";const A={name:"ExamineView",data(){return{showMessage:!1,message:"",errorType:"",selectedStatus:null,examineMessage:"",examineStatus:["通过","不通过"],showError:!1,examineItem:[],dialog:!1,nowExamineItem:{},TimeUtil:F,videoList:[],headers:[{title:"视频ID",align:"start",sortable:!1,key:"id"},{title:"创建时间",sortable:!1,key:"createTime",align:"center"},{title:"用户ID",sortable:!1,key:"userId",align:"center"},{title:"标题",sortable:!1,key:"title",align:"center"},{title:"封面",sortable:!1,key:"imgUrl",align:"center"},{title:"分区",sortable:!1,key:"category",align:"center"},{title:"类型",sortable:!1,key:"type",align:"center"},{title:"标签",sortable:!1,key:"tag",align:"center"},{title:"操作",key:"actions",sortable:!1,align:"center"}],page:1,size:15,length:1}},created(){this.init(),this.setExamineItem()},methods:{save(){let a=this.selectedStatus==="通过";const t={videoId:this.nowExamineItem.id,result:a,type:this.errorType,message:this.examineMessage};this.httpPost("/admin/examine",t,_=>{_.status===200?(this.message="审核结束",this.showMessage=!0,this.init(),this.dialog=!1,this.resetForm()):(this.message="审核失败："+_.message,this.showMessage=!0)})},resetForm(){this.selectedStatus=null,this.errorType="",this.examineMessage="",this.showError=!1},getErrorString(a){this.errorType=a},getexamineStatus(a){this.showError=a==="不通过"},examine(a){this.dialog=!0,this.nowExamineItem=a,this.resetForm()},init(){this.httpGet(`/admin/article/list?page=${this.page}&limit=${this.size}`,a=>{this.videoList=a.data.list,this.page=a.data.currPage,this.length=a.data.totalPage})},setExamineItem(){this.httpGet("/examine/item",a=>{this.examineItem=a.data})},pageChange({page:a}){this.loading=!0,this.page=a,this.init(),window.scrollTo({top:0,behavior:"smooth"})},getType(a){return a===0?"视频":a===1?"图片":a===2?"文章":"音乐"},getTypeColor(a){return a===0?"red":a===1?"blue":a===2?"green":"purple"}}},H={class:"d-flex flex-column"},J={class:"d-flex align-center"},K={class:"d-flex justify-center pa-4"},O={class:"text-center pt-2"};function Q(a,t,_,R,s,m){const I=i("v-toolbar-title"),x=i("v-spacer"),r=i("v-btn"),T=i("v-toolbar"),y=i("v-divider"),b=i("v-chip"),U=i("v-img"),v=i("v-icon"),E=i("v-tooltip"),S=i("v-pagination"),M=i("v-data-table-server"),w=i("v-card-text"),k=i("v-card"),z=i("v-card-title"),C=i("v-select"),f=i("v-col"),h=i("v-row"),L=i("v-textarea"),V=i("v-container"),N=i("v-card-actions"),P=i("v-dialog"),B=i("v-snackbar");return p(),u(V,{fluid:""},{default:e(()=>[o(k,{class:"mx-auto w-100",elevation:"2",rounded:"lg"},{default:e(()=>[o(T,{color:"red"},{default:e(()=>[o(I,{class:"text-h5 font-weight-medium"},{default:e(()=>t[9]||(t[9]=[n("内容审核管理")])),_:1}),o(x),o(r,{class:"mr-2","prepend-icon":"mdi-refresh",color:"white",variant:"tonal",onClick:m.init},{default:e(()=>t[10]||(t[10]=[n(" 刷新数据 ")])),_:1},8,["onClick"])]),_:1}),o(y),o(w,null,{default:e(()=>[o(M,{headers:s.headers,itemsLength:s.videoList.length,items:s.videoList,"items-per-page":s.size,page:s.page,"onUpdate:page":t[1]||(t[1]=l=>s.page=l),hover:"","onUpdate:options":m.pageChange},{"item.createTime":e(({item:l})=>[o(b,{size:"small"},{default:e(()=>[n(d(s.TimeUtil.renderTime(l.createTime)),1)]),_:2},1024)]),"item.type":e(({item:l})=>[o(b,{size:"small",color:m.getTypeColor(l.type),class:"text-white"},{default:e(()=>[n(d(m.getType(l.type)),1)]),_:2},1032,["color"])]),"item.userId":e(({item:l})=>[o(r,{to:`/user/${l.userId}`,variant:"text",color:"primary",density:"comfortable",target:"_blank"},{default:e(()=>[n(d(l.userId),1)]),_:2},1032,["to"])]),"item.imgUrl":e(({item:l})=>[o(U,{src:l.imgUrl,"max-height":"160px","max-width":"285px",class:"rounded-lg elevation-1",cover:""},null,8,["src"])]),"item.category":e(({item:l})=>[g("div",H,[l.childrenCategory&&l.childrenCategory.fatherId!==0?(p(),u(r,{key:0,to:`/v/${l.fatherCategory.id}`,variant:"text",color:"primary",size:"small",class:"mb-1",density:"comfortable"},{default:e(()=>[n(d(l.fatherCategory.name),1)]),_:2},1032,["to"])):c("",!0),l.childrenCategory&&l.childrenCategory.fatherId!==0?(p(),u(y,{key:1,class:"mb-1"})):c("",!0),l.childrenCategory?(p(),u(r,{key:2,to:`/v/${l.childrenCategory.id}`,variant:"text",color:"primary",size:"small",density:"comfortable"},{default:e(()=>[n(d(l.childrenCategory.name),1)]),_:2},1032,["to"])):c("",!0)])]),"item.actions":e(({item:l})=>[g("div",J,[o(r,{href:`/video/${l.id}`,target:"_blank",icon:"",color:"primary",size:"small",class:"mr-2"},{default:e(()=>[o(v,null,{default:e(()=>t[11]||(t[11]=[n("mdi-video")])),_:1})]),_:2},1032,["href"]),o(E,{location:"top"},{activator:e(({props:D})=>[o(r,q({icon:""},D,{color:"warning",size:"small",onClick:W=>m.examine(l)}),{default:e(()=>[o(v,null,{default:e(()=>t[12]||(t[12]=[n("mdi-pencil")])),_:1})]),_:2},1040,["onClick"])]),default:e(()=>[t[13]||(t[13]=g("span",null,"审核内容",-1))]),_:2},1024)])]),"no-data":e(()=>[g("div",K,[o(r,{color:"primary",onClick:m.init},{default:e(()=>t[14]||(t[14]=[n("加载数据")])),_:1},8,["onClick"])])]),bottom:e(()=>[g("div",O,[o(S,{modelValue:s.page,"onUpdate:modelValue":t[0]||(t[0]=l=>s.page=l),length:s.length,"total-visible":7,rounded:""},null,8,["modelValue","length"])])]),_:2},1032,["headers","itemsLength","items","items-per-page","page","onUpdate:options"])]),_:1})]),_:1}),o(P,{modelValue:s.dialog,"onUpdate:modelValue":t[6]||(t[6]=l=>s.dialog=l),persistent:"","max-width":"600px"},{default:e(()=>[o(k,null,{default:e(()=>[o(z,{class:"text-h5 bg-primary text-white"},{default:e(()=>[o(v,{class:"mr-2"},{default:e(()=>t[15]||(t[15]=[n("mdi-clipboard-check")])),_:1}),n(" 审核 - "+d(s.nowExamineItem.title),1)]),_:1}),o(w,{class:"pt-4"},{default:e(()=>[o(V,null,{default:e(()=>[o(h,null,{default:e(()=>[o(f,null,{default:e(()=>[o(C,{modelValue:s.selectedStatus,"onUpdate:modelValue":[t[2]||(t[2]=l=>s.selectedStatus=l),m.getexamineStatus],items:s.examineStatus,label:"审核结果",variant:"outlined"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1})]),_:1}),s.showError?(p(),u(h,{key:0},{default:e(()=>[o(f,null,{default:e(()=>[o(C,{modelValue:s.errorType,"onUpdate:modelValue":[t[3]||(t[3]=l=>s.errorType=l),m.getErrorString],items:s.examineItem,label:"不通过原因",variant:"outlined"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1})]),_:1})):c("",!0),s.showError?(p(),u(h,{key:1},{default:e(()=>[o(f,null,{default:e(()=>[o(L,{modelValue:s.examineMessage,"onUpdate:modelValue":t[4]||(t[4]=l=>s.examineMessage=l),label:"处理意见",variant:"outlined",rows:"3"},null,8,["modelValue"])]),_:1})]),_:1})):c("",!0)]),_:1})]),_:1}),o(N,null,{default:e(()=>[o(x),o(r,{color:"grey",variant:"text",onClick:t[5]||(t[5]=l=>s.dialog=!1)},{default:e(()=>t[16]||(t[16]=[n("取消")])),_:1}),o(r,{color:"primary",variant:"elevated",onClick:m.save},{default:e(()=>t[17]||(t[17]=[n("确认")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(B,{modelValue:s.showMessage,"onUpdate:modelValue":t[8]||(t[8]=l=>s.showMessage=l),timeout:3e3,location:"top",color:"primary"},{actions:e(()=>[o(r,{color:"white",variant:"text",onClick:t[7]||(t[7]=l=>s.showMessage=!1)},{default:e(()=>t[18]||(t[18]=[n(" 关闭 ")])),_:1})]),default:e(()=>[n(d(s.message)+" ",1)]),_:1},8,["modelValue"])]),_:1})}const Z=G(A,[["render",Q],["__scopeId","data-v-86418117"]]);export{Z as default};
